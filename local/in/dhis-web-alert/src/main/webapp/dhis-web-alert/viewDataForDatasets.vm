<script type="text/javascript">
	
	jQuery( function(){
	datePicker("startDate")
	});
        
	jQuery( function(){
	datePicker("endDate")
	});
    
	function formValidations()
	{
		var datasetIdIndex = document.viewData.datasetId.selectedIndex;
		var startDateValue = $( '#startDate' ).val(); 
		var endDateValue = $( '#endDate' ).val();			
			               			            
		if(datasetIdIndex < 0 || document.viewData.datasetId.options[datasetIdIndex].value == "NA") {alert("Please Select Dataset"); return false;}
		else if(startDateValue == null || startDateValue== "" ) {alert("Please Select Start Date"); return false;}
		else if(endDateValue == null || endDateValue=="") {alert("Please Select End Date"); return false;}
		else if(startDateValue > endDateValue) {alert("Start Date is Greater than End Date"); return false;}				

		return true;
	}

    function sortList()
    {
        var cl = document.getElementById('datasetId');
        var clTexts = new Array();

        for(i = 1; i < cl.length; i++)
        {
            clTexts[i-1] =
                    cl.options[i].text.toUpperCase() + "," +
                            cl.options[i].text + "," +
                            cl.options[i].value;
        }

        clTexts.sort();

        for(i = 1; i < cl.length; i++)
        {
            var parts = clTexts[i-1].split(',');

            cl.options[i].text = parts[1];
            cl.options[i].value = parts[2];
        }
    }
    
    function loadOrgUnitTreeWithSelectedOrgUnits()
    {    
    	document.viewData.startDate.value = '';
    	document.viewData.endDate.value = '';
		var datasetIdValue = $( '#dataSetId' ).val();
    	var url = 'defineDataSetAssociationsForm.action?dataSetId=' + datasetIdValue;    	
    	window.location.href = url;
    }
	
</script>

<form id="viewData" name="viewData" method="post" onsubmit="return formValidations()" action="viewDataResultAction.action" >
	
<h4>$i18n.getString( "view_data" )</h4>
	
<table align="left" style=" border-collapse: collapse; margin-top: 0;" cellpadding="0" cellspacing="0"  border=0>                      
	<tr>				
		<th style="min-width: 45px">$i18n.getString( "dataset_selection" )</th>
		<td>&nbsp;&nbsp;&nbsp;&nbsp;</td>	
		<th style="min-width: 10px">Start Date</th>
		<td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
		<th style="min-width: 10px">End Date</th>	   	
	</tr>
	<tr>
		<td>
			<select id="dataSetId" name="dataSetId" style="width:23em" onChange="loadOrgUnitTreeWithSelectedOrgUnits()">
				<option value="NA">[ $i18n.getString( "select_dataset" ) ]</option>
			    #foreach ( $dataset in $datasets )
					<option value="$dataset.id" #if( $dataset.id == $dataSetId ) selected #end>$dataset.name</option>
				#end
			</select>
		</td>
		<td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
		<td class="NormalB">
			<input type="text" id="startDate" name="startDate" value="$!startDate" style="width:10em" />
        </td>
		<td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
		<td class="NormalB">
			<input type="text" id="endDate" name="endDate" value="$!endDate" style="width:10em" />
		</td>
	</tr>
    <tr>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
    </tr>
	<tr>
		<td colspan="5">
			<table id="selectionTable">
				<tr>
	  				<td>
						#organisationUnitSelectionTree( false, true, false )
	 				</td>
    			</tr>
    		</table>	
		</td>
	</tr>
	<tr>
		<td>
			<input type="submit" id= "viewData" name="viewData" value="View Data" style="float:left; width:13em;" />
		</td>
	</tr>
	<!--
    <tr>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
    </tr>
	-->
</table>	

<!--
<br/>
#organisationUnitSelectionTree( false, true, false )

<input type="submit" id= "viewData" name="viewData" value="View Data" style="float:left; width:13em;" />
-->
</form>

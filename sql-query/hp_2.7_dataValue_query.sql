
IP - 88.80.191.115
port -- 22
mithilesh
M!th!lesh@123
database_userName -- dhis
dhis@hisp

database_name - hp_upgraded
SELECT * FROM PERIOD WHERE periodid = 417;

SELECT * FROM PERIOD WHERE periodtypeid = 3 ORDER BY startdate DESC;

SELECT startdate, 
SUBSTRING_INDEX(startdate,'-', 2) AS STRING 
FROM PERIOD WHERE periodtypeid = 3 ORDER BY startdate DESC;

SELECT startdate, SUBSTRING_INDEX(startdate,'-', 2) AS STRING , 
SUBSTRING_INDEX(SUBSTRING_INDEX(startdate, '-', 2), '-', -1) AS STRING
FROM PERIOD WHERE periodtypeid = 3 ORDER BY startdate DESC;

SELECT SUBSTRING_INDEX(SUBSTRING_INDEX('2021-11-01', '-', 2), '-', -1) AS JoiningMonth

SELECT startdate, SUBSTRING_INDEX(startdate,'-', 1) AS STRING , 
SUBSTRING_INDEX(SUBSTRING_INDEX(startdate, '-', 2), '-', -1) AS STRING
FROM `period` WHERE periodtypeid = 3 ORDER BY startdate DESC;

SELECT startdate, 
CONCAT(SUBSTRING_INDEX(startdate,'-', 1),SUBSTRING_INDEX(SUBSTRING_INDEX(startdate, '-', 2), '-', -1) ) AS STRING
FROM `period` WHERE periodtypeid = 3 ORDER BY startdate DESC;


SELECT * FROM organisationunit WHERE parentid IN( 
SELECT organisationunitid FROM organisationunit WHERE  parentid IN (SELECT organisationunitid FROM
organisationunit WHERE uid = 'xh2pgxFlEbk' ));


-- jan 2021 - 417

SELECT de.uid AS dataElementUID,dv.dataelementid, dv.periodid, dv.sourceid, org.uid AS organisationunitUID, 
dv.categoryoptioncomboid, coc.uid AS ategoryoptioncomboUID, dv.value, dv.lastupdated FROM datavalue dv
INNER JOIN dataelement de ON de.dataelementid = dv.dataelementid
INNER JOIN categoryoptioncombo AS coc ON coc.categoryoptioncomboid = dv.categoryoptioncomboid
INNER JOIN organisationunit org ON org.organisationunitid = dv.sourceid
WHERE dv.periodid = 385;


SELECT de.uid AS dataElementUID,dv.dataelementid, dv.periodid, dv.sourceid, org.uid AS organisationunitUID, 
dv.categoryoptioncomboid, coc.uid AS categoryoptioncomboUID, dv.value, dv.lastupdated,dv.storedby, 
CONCAT(SUBSTRING_INDEX(startdate,'-', 1),SUBSTRING_INDEX(SUBSTRING_INDEX(startdate, '-', 2), '-', -1) ) AS isoPeriod
FROM datavalue dv
INNER JOIN dataelement de ON de.dataelementid = dv.dataelementid
INNER JOIN categoryoptioncombo AS coc ON coc.categoryoptioncomboid = dv.categoryoptioncomboid
INNER JOIN organisationunit org ON org.organisationunitid = dv.sourceid
INNER JOIN PERIOD pe ON pe.periodid = dv.periodid
WHERE dv.periodid = 417;

-- jan- 2021  total record -- 618329

SELECT de.uid AS dataElementUID, coc.uid AS categoryOptionComboUID, org.uid AS organisationunitUID, 
dv.value, dv.lastupdated, dv.storedby, 
CONCAT(SUBSTRING_INDEX(startdate,'-', 1),SUBSTRING_INDEX(SUBSTRING_INDEX(startdate, '-', 2), '-', -1) ) AS isoPeriod
FROM datavalue dv
INNER JOIN dataelement de ON de.dataelementid = dv.dataelementid
INNER JOIN categoryoptioncombo AS coc ON coc.categoryoptioncomboid = dv.categoryoptioncomboid
INNER JOIN organisationunit org ON org.organisationunitid = dv.sourceid
INNER JOIN `period` pe ON pe.periodid = dv.periodid
WHERE dv.periodid = 417;


SELECT de.uid AS dataElementUID, coc.uid AS categoryoptioncomboUID, org.uid AS organisationunitUID, 
dv.value AS dataValue, dv.lastupdated AS lastUpdated , dv.storedby AS storedBy, 
CONCAT(SUBSTRING_INDEX(pe.startdate,'-', 1),SUBSTRING_INDEX(SUBSTRING_INDEX(pe.startdate, '-', 2), '-', -1) ) 
AS isoPeriod FROM datavalue dv
INNER JOIN dataelement de ON de.dataelementid = dv.dataelementid
INNER JOIN categoryoptioncombo AS coc ON coc.categoryoptioncomboid = dv.categoryoptioncomboid
INNER JOIN organisationunit org ON org.organisationunitid = dv.sourceid
INNER JOIN `period` pe ON pe.periodid = dv.periodid
WHERE dv.dataelementid IN ( 6023) AND dv.sourceid IN (
SELECT organisationunitid FROM organisationunit WHERE  parentid IN( 1027,5725,
5726,5727,5728,5729,5731,5732,5733,5734,5735,6346,6469));


-- hp 2.7 datavalue for sync
-- HP -2.7 mysql datavalue query with isoperiod
SELECT de.uid AS dataElementUID, coc.uid AS categoryoptioncomboUID, org.uid AS organisationunitUID, 
dv.value AS dataValue, dv.lastupdated AS lastUpdated , dv.storedby AS storedBy , 
CONCAT(SUBSTRING_INDEX(startdate,'-', 1),SUBSTRING_INDEX(SUBSTRING_INDEX(startdate, '-', 2), '-', -1) ) AS isoPeriod
FROM datavalue dv
INNER JOIN dataelement de ON de.dataelementid = dv.dataelementid
INNER JOIN categoryoptioncombo AS coc ON coc.categoryoptioncomboid = dv.categoryoptioncomboid
INNER JOIN organisationunit org ON org.organisationunitid = dv.sourceid
INNER JOIN `period` pe ON pe.periodid = dv.periodid
WHERE dv.periodid = 417 and dv.dataelementid in ( 5978,6073,6028,6081,130,6053,12,10,3,4,6091,7,
6080,6118,6024,6054,1485,6124,68,6078,5954,6233,5953,6038,6040,6037,6070,5976,62,6228,6001,6088,
6018,6089,6008,6005,6007,6014,6133,6134,61,6074,6075,26,39,31,19,105,6220,99,6043,6128,71,74,77,
83,6120,87,11,63,6157,522,516,518,81,80,6036,6039,6041,135,6125,5724,72,75,78,138,139,136,137,6110,
6108,6109,94,93,92,129,5996,5997,6136,6114,6115,6135,5988,5991,5989,5990,6058,6057,6056,6055,6060,
6063,6061,6066,6067,6065,6064,6062,126,125,124,123,128,127,6132,58,59,95,6033,6034,5957,6119,52,6131,
6107,6122,23,24,5955,106,6032,6031,150,151,152,521,515,517,6010,6129,79,5723,104,84,6117,54,56,6116,
44,43,6237,5983,47,46,6086,5975,5960,5982,5986,50,6158,6021,6016,6025,6012,6230,6162,6161,6015,6013,6022,
6160,6159,6020,5973,5974,6146,6147,6148,6149,6145,5987,6003,6004,6002,6006,6009,6011,6087,6103,6102,6141,
6142,6143,6144,6140,6138,6139,6137,6059,6100,6152,6150,6151,6153,6155,6154,5979,5980,5985,5977,6097,5970,
5971,5972,6071,6042,131,132,6126,69,70,73,76,82,60,6112,6099,6098,5964,6085,6084,6047,6051,6044,6049,6045,
6048,6052,6050,6046,5951,6068,100,6023,107,5984,41,40,6035,5956,35,5958,5959,5963,5969,5961,5966,5962,5965,
5967,5968,6225,6106,6030,6219,154,5998,5999,6000,6026,13,6029,6019,6072,6083,6082,1139,1139,64,65,66,67,32,
5952,6121,6226,6227,101,88,89,6156,5944,5940,5942,5943,5946,6101,5947,5993,5981,134,6069,6123,6027,5949,90,
91,6111,6130,96,97,98,6224,142,143,6113,33,1486,9,140,141,6,8,148,149,120,38,36,37,29,28,27,1484,121,122,520,
86,85,118,519,45,17,5,156,117,5939,5939,5939,5939,5939,42,103,119,102,144,145,146,147,1115,48,1256,6017,1253,
1281,
1268,
1272,
1276,
1264,
1260,
5950,
5950,
6229,
6229,
6221,
6236,
25,
21,
20,
1258,
1505,
1257,
1255,
1252,
1251,
1254,
15,
14,
30,
1282,
1269,
1273,
1277,
1265,
1261,
6092,
5994,
1204,
1204,
372,
372,
372,
372,
372,
373,
373,
373,
373,
373,
374,
374,
374,
374,
374,
6200,
6197,
6177,
6177,
6177,
6177,
6177,
348,
348,
348,
348,
348,
361,
361,
361,
361,
361,
6191,
6193,
6178,
6178,
6178,
6178,
6178,
6169,
6169,
6169,
6169,
6169,
6202,
6180,
6181,
6201,
6188,
6189,
353,
353,
353,
353,
353,
344,
344,
344,
344,
344,
347,
347,
347,
347,
347,
6190,
355,
355,
355,
355,
355,
6184,
6186,
6182,
6192,
6194,
358,
358,
358,
358,
358,
362,
362,
362,
362,
362,
351,
351,
351,
351,
351,
6172,
6172,
6172,
6172,
6172,
364,
364,
364,
364,
364,
363,
363,
363,
363,
363,
6173,
6173,
6173,
6173,
6173,
6170,
6170,
6170,
6170,
6170,
6166,
6166,
6166,
6166,
6166,
357,
357,
357,
357,
357,
6168,
6168,
6168,
6168,
6168,
352,
352,
352,
352,
352,
350,
350,
350,
350,
350,
6185,
6187,
6183,
6207,
6205,
6206,
6167,
6167,
6167,
6167,
6167,
349,
349,
349,
349,
349,
359,
359,
359,
359,
359,
6179,
345,
345,
345,
345,
345,
354,
354,
354,
354,
354,
367,
367,
367,
367,
367,
6195,
6196,
6203,
6204,
6174,
6174,
6174,
6174,
6174,
6171,
6171,
6171,
6171,
6171,
6210,
6209,
6213,
6211,
6208,
6212,
6165,
6165,
6165,
6165,
6165,
6175,
6175,
6175,
6175,
6175,
6199,
6198,
6214,
6215,
6216,
6217,
6218,
360,
360,
360,
360,
360,
346,
346,
346,
346,
346,
356,
356,
356,
356,
356,
6163,
6163,
6163,
6163,
6163,
366,
366,
366,
366,
366,
6164,
6164,
6164,
6164,
6164,
6176,
6176,
6176,
6176,
6176,
1183,
161,
168,
171,
172,
1179,
1181,
1180,
1164,
1159,
1165,
1161,
1158,
1157,
1152,
1156,
1155,
1153,
1167,
1166,
1160,
1163,
1154,
1162,
1171,
1176,
1170,
1172,
1173,
1177,
1175,
1169,
1174,
1168,
164,
165,
166,
1184,
177,
169,
1508,
1506,
1182,
163,
167,
1178,
170,
173,
174,
368,
368,
368,
368,
368,
369,
369,
369,
369,
369,
365,
365,
365,
365,
365,
370,
370,
370,
370,
370,
371,
371,
371,
371,
371,
22,
1208,
1208,
1140,
1140,
1220,
1220,
1210,
1210,
1142,
1142,
1222,
1222,
1121,
1121,
1230,
1230,
1236,
1236,
1145,
1145,
1213,
1213,
1225,
1225,
566,
567,
570,
569,
568,
571,
555,
552,
1128,
1128,
1205,
1205,
1133,
1133,
1243,
1243,
1217,
1217,
565,
561,
563,
559,
557,
1196,
554,
1198,
1215,
1215,
1147,
1147,
1227,
1227,
1206,
1206,
1136,
1136,
1218,
1218,
1247,
1247,
1229,
1229,
1124,
1124,
1233,
1233,
1239,
1239,
1123,
1123,
1232,
1232,
1238,
1238,
1199,
1199,
1135,
1135,
1203,
1203,
1246,
1246,
1200,
1200,
564,
560,
562,
558,
556,
1195,
553,
1197,
528,
540,
542,
541,
539,
538,
530,
531,
532,
529,
536,
533,
537,
1489,
535,
534,
1483,
527,
524,
523,
525,
526,
1129,
1129,
1244,
1244,
1250,
1250,
1132,
1132,
1126,
1126,
1235,
1235,
1241,
1241,
1207,
1207,
1137,
1137,
1248,
1248,
1219,
1219,
1130,
1130,
1211,
1211,
1223,
1223,
1143,
1143,
1144,
1144,
1212,
1212,
1224,
1224,
1249,
1249,
1131,
1131,
1125,
1125,
1234,
1234,
1240,
1240,
1127,
1127,
1242,
1242,
543,
548,
547,
545,
550,
549,
551,
544,
546,
1138,
1138,
1214,
1214,
1146,
1146,
1226,
1226,
1122,
1122,
1231,
1231,
1237,
1237,
1216,
1216,
1148,
1148,
1228,
1228,
1209,
1209,
1141,
1141,
1221,
1221,
1201,
1201,
1134,
1134,
1245,
1245,
1202,
1202,
1488,
162,
16,
1283,
1280,
1279,
1270,
1267,
1274,
1271,
1278,
1275,
1266,
1263,
1262,
1259,
6232,
6104,
6105,
6079,
5992,
6243,
6242,
6241,
6240,
6239,
5727,
5726,
5757,
5757,
5725,
5728,
5728,
5728,
5756,
5756,
5755,
5755,
5758,
5758,
5764,
5764,
5760,
5760,
5761,
5761,
5762,
5762,
5763,
5763,
5766,
5766,
5765,
5765,
5759,
5759,
5995,
1189,
1186,
1193,
1191,
176,
175,
1192,
1190,
1187,
1194,
1188,
1185,
6234,
6231,
5945);


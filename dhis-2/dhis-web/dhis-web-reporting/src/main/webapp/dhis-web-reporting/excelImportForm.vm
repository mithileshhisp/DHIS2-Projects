
<script>

    //Global Variables
    var selriRadioButton = "overWrite";
    var reportModels = new HashTable();
    var reportFileNames = new HashTable();
    var checkerFileNames = new HashTable();
    var reportDatasets = new HashTable();

    function formValidations()
    {                       
        var reportListIndex = document.reportForm.reportList.selectedIndex;
        var periodIndex = document.reportForm.availablePeriods.selectedIndex;
        var periodIDIndex = document.reportForm.periodTypeId.selectedIndex;
        var orgunitIdValue = document.reportForm.ouIDTB.value;

        if(reportListIndex < 0 || document.reportForm.reportList.options[reportListIndex].text == null) {alert("Please Select Report"); return false;}
        else if(document.reportForm.availablePeriods.options[periodIndex].text == null || document.reportForm.availablePeriods.options[periodIndex].text== "") {alert("Please Select Period"); return false;}
        else if(document.reportForm.periodTypeId.options[periodIDIndex].value == "NA") {alert("Please Select Period Type"); return false;}
        else if(orgunitIdValue == null || orgunitIdValue=="" || orgunitIdValue==" ") {alert("Please Select OrganisationUnit"); return false;}

        document.reportForm.reportModelTB.value = reportModels.get(document.reportForm.reportList.options[reportListIndex].value);
        document.reportForm.reportFileNameTB.value = reportFileNames.get(document.reportForm.reportList.options[reportListIndex].value);
        document.reportForm.checkerFileNameTB.value = checkerFileNames.get(document.reportForm.reportList.options[reportListIndex].value);
        document.reportForm.dataSetId.value = reportDatasets.get(document.reportForm.reportList.options[reportListIndex].value);
	
		
        return true;
    }

    //-----------------------------------------------------------------------
    //init jQuery validation for reportForm
    //-----------------------------------------------------------------------
    jQuery(document).ready(
            function()
            {
                jQuery("#reportForm").validate({
                     meta:"validate"
                    ,errorElement:"td"
                    ,submitHandler: function(form)
                    {
                        //formValidations();
						submitImportForm();
                    }
                });
                jQuery("#name").focus();
            }
    );
    

</script>

<h1>Excel Import Form</h1>
<hr /><br />
    
<form id="reportForm" name="reportForm" method="post" enctype="multipart/form-data" action="excelImportResultForm.action">
   <table>
    <tr>
      <td class="NormalB">Upload/Import (XLS) File :</td>
      <td>&nbsp;</td>

      <td class="NormalB">
        <input type="file" id="upload" name="upload" size="31" class="{validate:{required:true}}">
      </td>
    </tr>

    <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
    <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>

    <tr>
      <td class="NormalB">
        <input type="submit" name="importReport" value='Import Data' style="width:150px">
      </td>
    </tr>

  </table>
</form>

<script>
    
</script>

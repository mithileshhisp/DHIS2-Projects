<script type="text/javascript" src="javascript/addASHA_1.js"></script>
## Macro for generating the jQuery validation rules 
#macro( validate $type $require )
  #if( $type == "NUMBER" )
  	{validate:{ number:true #if($require), required:true #end }}
  #elseif( $type == "string" )
  	{validate:{ alphanumeric:true #if($require), required:true #end }}
  #elseif( $require )
  	{validate:{required:true}}
  #end
#end

<h3>$i18n.getString( "add_asha_profile" ) - $!organisationUnit.name</h3>

<script>

jQuery(document).ready(	function()
{			
    currentDiv = 'addASHAProfileForm';
	
	var dobType = $('#addASHAProfileForm [id=dobType]').val();
    
    if( dobType=='V' || dobType=='D' ) 
    {
    	var birthDate = $('#addASHAProfileForm [id=birthDate]').val();
		
    	if( birthDate != '' )
    	{
    		$("#addASHAProfileForm [id=memberValidator]").val(birthDate);
    	}
    }
    
    else
    {
    	var age = $('#addASHAProfileForm [id=age]').val();
    	$("#addASHAProfileForm [id=memberValidator]").val(age);
    }



    datePickerValid( 'addASHAProfileForm [id=registrationDate]' );
    datePickerValid( 'addASHAProfileForm [id=birthDate]' );
    addEventForASHAForm( 'addASHAProfileForm' );
	
	
	
	jQuery(document).ready(	function(){

		currentDiv = 'addASHAProfileForm';
		checkedDuplicate = false;
		
		jQuery("#addASHAProfileForm").validate({
				 meta:"validate"
				,errorElement:"span"
				,submitHandler: function(form)
					{
						form.submit();
					}
				,beforeValidateHandler: function(form)
					{
						var dobType = $('#addASHAProfileForm [id=dobType]').val();
						
						if( dobType=='V' || dobType=='D' ) 
						{
							var birthDate = $('#addASHAProfileForm [id=birthDate]').val();
							if( birthDate != '' ){
								$("#addASHAProfileForm [id=memberValidator]").val(birthDate);
							}
						}else{
							var age = $('#addASHAProfileForm [id=age]').val();
							$("#addASHAProfileForm [id=memberValidator]").val(age);
						}
					}
			});
		
		datePickerValid( 'addASHAProfileForm [id=registrationDate]' );
		datePickerValid( 'addASHAProfileForm [id=birthDate]' );
		addEventForASHAForm( 'addASHAProfileForm' );
	});	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
});

</script>

<h4>$i18n.getString( "add_new_asha" )</h4>

<form id="addASHAProfileForm" name="addASHAProfileForm"  action="addASHAProperties.action" method="post" >

<table>

<tr style='display:none'>
	<td class='text-column'><label for="registration_date">$i18n.getString( "registration_date" )<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
	<td class="input-column" colspan='2'>
		<input type="text" id="registrationDate" name="registrationDate" class="{validate:{required:true}}"/>
		<script type="text/javascript">
			datePickerValid( 'registrationDate', true );
		</script>    
	</td>		
</tr>

<tr>
	<td class='text-column'><label for="fullName">$i18n.getString( "full_name_asha" )<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
	<td class="input-column">
		<input type="text" id="fullName" name="fullName" class="{validate:{required:true, unicodechars:true, rangelength:[7,50]}}"/>
	</td>
</tr>

<tr style='display:none'>
	<td class='text-column'><label for="gender">$i18n.getString( "gender" )<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
	<td class="input-column">
		<select id="gender" name="gender" class="{validate:{required:true}}" readonly >
			<option value="F">$i18n.getString( "female" )</option>
		</select>
	</td>		
</tr>

<tr>
	<td class='text-column'><label for="birthDate">$i18n.getString( "date_of_birth" )<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
	<td class="input-column">	
		<select id='dobType' name="dobType" style='width:120px' onchange='dobTypeOnChange("addASHAProfileForm")' >
			<!--<option value="V" selected>$i18n.getString( "verified" )</option>-->
			<!--<option value="D" >$i18n.getString( "declared" )</option>-->
			<option value="A" >$i18n.getString( "approximated" )</option>
			<option value="D" >$i18n.getString( "declared" )</option>
		</select>
		<input type="text" id="age" name="age" placeholder="Enter age in years..." class="{validate:{number:true}}" style="width:136px;display:none;" onchange="ageValidation();"/>
		<input type="text" id="birthDate" name="birthDate" style='width:136px;' onchange="dobValidation();"/>
		<input id="memberValidator" class="hidden {validate:{required:true}}"/>
	</td>
	
    <td style="display:none">
		<input type="text" id="bobOfASHA" name="bobOfASHA"/>
    </td>	
</tr>

	
<tr>
	<td></td>
	<td>
		<input type="submit" class="button" value="$i18n.getString( 'add' )"/>
		<!--<input type="button" class="button" value="$i18n.getString( 'back_to_registration' )" onclick="javascript:callAction( 'getRegisteredASHAList' )"/>-->
		<input type="button" class="button" value="$i18n.getString( 'back_to_registration' )" onclick="window.location.href='selectASHA.action'"/>
	</td>
</tr>
	
	
</table>

</form>

<!--
<script>
	var i18n_error_connect_to_server = '$encoder.jsEscape( $i18n.getString( "error_connect_to_server" ) , "'" )';
	var i18n_add_person_successfully = '$encoder.jsEscape( $i18n.getString( "add_person_successfully" ) , "'" )';
	
	var i18n_adding_asha_failed = '$encoder.jsEscape( $i18n.getString( "adding_asha_failed" ), "'")';
	var i18n_no_duplicate_found = '$encoder.jsEscape( $i18n.getString( "no_duplicate_found" ) , "'")';
	var i18n_asha_system_id = '$encoder.jsEscape( $i18n.getString( "asha_system_id" ) , "'")';
	var i18n_patient_full_name = '$encoder.jsEscape( $i18n.getString( "full_name" ) , "'")';
	var i18n_patient_gender = '$encoder.jsEscape( $i18n.getString( "gender" ) , "'")';
	var i18n_patient_date_of_birth = '$encoder.jsEscape( $i18n.getString( "date_of_birth" ) , "'")';
	var i18n_patient_age = '$encoder.jsEscape( $i18n.getString( "age" ) , "'")';
	var i18n_patient_phone_number = '$encoder.jsEscape( $i18n.getString( "phone_number" ) , "'")';
	var i18n_create_new_patient = '$encoder.jsEscape( $i18n.getString( "create_new_patient" ) , "'")';
	var i18n_duplicated_asha_list = '$encoder.jsEscape( $i18n.getString( "duplicated_asha_list" ) , "'")';
	var i18n_patient_attributes = '$encoder.jsEscape( $i18n.getString( "asha_attributes" ) , "'")';
	var i18n_duplicate_warning = '$encoder.jsEscape( $i18n.getString( "duplicate_warning" ) , "'")';
	var i18n_edit_this_patient = '$encoder.jsEscape( $i18n.getString( "edit_this_patient" ) , "'")';
	
	"alphanumericwithbasicpuncspaces" : true
	"required": true
	"rangelength" : [ 2,160 ]
	"digits" : true
	"number" : true
	"alphanumeric" : true
	
	
</script>
-->

<script type="text/javascript">
	dobTypeOnChange("addASHAProfileForm");
	//ageValidation();
	//dobValidation();
	
</script>